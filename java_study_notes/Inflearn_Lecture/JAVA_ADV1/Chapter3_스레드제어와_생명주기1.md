# 📚 Chapter 3: 스레드 제어와 생명 주기1

> 📌 공부 날짜: 2025/04/14
> - `JAVA `- 고급1편
> - `Reference`: 인프런 - 김영한의 실전 자바

---

## ✅ 스레드 기본 정보

### 📚 1. 스레드 생성
- 스레드를 생성할 때에는 실행할 `Runnable` 인터페이스의 구현체와 스레드의 이름을 전달할 수 있다.
```java
Thread myThread = new Thread(new HelloRunnabl(), "myThread");
```
- 스레드 이름: 이 이름은 디버깅이나 로깅 목적으로 유용하다.

---

### 📚 2. 스레드 객체 정보
- Thread 객체를 문자열로 반환하여 출력한다.
- Thread 클래스의 toString() 메서드는 스레드 ID, 스레드 이름, 우선순위, 스레드 그룹을 포함하는 문자열을 반환한다.
  - 결과 예시) Thread[#21, myThread, 5, main]

---

### 📚 3. 스레드 ID
```java
myThread.threadId();
```

- threadId(): 스레드의 고유 식별자를 반환하는 메서드이다.
  - 이 ID는 JVM 내에서 각 스레드에 대해 유일하다.
- ID는 스레드가 생성될 때 할당되며, 직접 지정할 수 없다.

---

### 📚 4. 스레드 이름
```java
myThread.getName();
```

- getName(): 스레드의 이름을 반환하는 메서드. 스레드 이름은 중복될 수 있다.

---

### 📚 5. 스레드 우선순위
```java
myThread.getPriority();
```

- getPriority(): 스레드의 우선순위를 반환하는 메서드이다.
  - 우선순위는 1(가장 낮음)에서 10(가장 높음)까지의 값으로 설정할 수 있으며, 기본 값은 5이다.
  - setPriority() 매서드를 이용해서 우선순위를 변경할 수 있다.
- 우선순위는 스레드 스케줄러가 어떤 스레드를 우선 실행할지 결정하는데 사용된다.
  - 하지만 실제 실행 순서는 JVM 구현과 운영체제에 따라 달라질 수 있다.

---

### 📚 6. 스레드 그룹 (자주 사용 ❌)
```java
myThread.getThreadGroup();
```

- getThreadGroup(): 스레드가 속한 스레드 그룹을 반환하는 메서드이다.
  - 기본적으로 모든 스레드는 부모 스레드와 동일한 스레드 그룹에 속해 있다.
  - 부모 스레드(Parent Thread): 새로운 스레드를 생성하는 스레드를 의미한다.
    - 예를 들어 myThread는 main 스레드에 의해 생성이 되었다면, main 스레드가 부모 스레드이다.

---

### 📚 7. 스레드 상태
```java
myThread.getState();
```

- getState(): 스레드의 현재 상태를 반환하는 메서드이다.
  - 반환되는 값은 Thread.state 열거형에 정의된 상수 중 하나이다.

1. New (새로운 상태)
    - 스레드가 생성되고 아직 시작되지 않은 상태이다.
    - 이 상태에서는 Thread 객체가 생성되었디만, start() 메서드가 호출되지 않은 상태이다.

2. Runnable (실행 가능 상태)
   - 스레드가 실행될 준비가 된 상태이다. 이 상태에서 스레드는 실제로 CPU에 실행될 수 있다.
   - start() 메서드가 호출되면 스레드는 이 상태로 들어간다.

3. Blocked (차단 상태)
   - 스레드가 다른 스레드에 의해 동기화 락을 얻기 위해 기다리는 상태이다.
   - 예를 들어, synchronized 블록에 진입하기 위해 락을 얻어야 하는 경우 이 상태로 들어간다.

4. Waiting (대기 상태)
   - 스레드가 다른 스레드의 특정 작업이 완료되기를 무한히 기다리는 상태이다.
   - wait(), join() 메서드가 호출될 때 이 상태가 온다.
   - 스레드는 다른 스레드가 notify() 또는 notifyAll() 메서드를 호출하거나, join()이 완료될 때까지 기다린다.

5. Time Waiting (시간 제한 대기 상태)
   - 스레드가 특정 시간 동안 다른 스레드의 작업이 완료되기를 기다리는 상태이다.
   - sleep(long millis), wait(long timeout), join(long millis) 메서드가 호출될 때 이 상태가 된다.
   - 주어진 시간이 경과하거나 다른 스레드가 해당 스레드를 깨우면 이 상태에서 벗어난다.

6. Terminated (종료 상태)
    - 스레드의 실행이 완료된 상태이다.
    - 스레드가 정상적으로 종료되거나, 예외가 발생하여 종료된 경우 이 상태로 들어간다.
    - 스레든느 한 번 종료되면 다시 시작할 수 없다.

---

## ✅ 체크 예외 재정의
- Runnable 인터페이스의 run() 메서드를 구현할 때, InterruptedException 체크 예외를 밖으로 던질 수 없다.
- 자바에서 메서드를 재정의 할 때, 재정의 메서드가 지켜야 할 예외와 관련된 규칙이 있다.
  - 체크 예외
    - 부모 메서드가 체크 예외를 던지지 않는 경우, 재정의된 자식 메서드도 체크 예외를 던질 수 없다.
    - 자식 메서드는 부모 메서드가 던질 수 있는 체크 예외의 하위 타입만 던질 수 있다.
- Runnable 인터페이스의 run() 메서드는 아무런 체크 예외를 던지지 않기 때문에 재정의한 run() 메서드 또한 체크 예외를 던질 수 없다.

---

## ✅ join - 필요한 상황
- 예를 들어서 main 스레드가 thread-1, thread-2에 각각 어떤 작업을 지시하고, 그 결과를 받아서 처리하고 싶다면 어떻게 해야 할까?
  - 1 ~ 100까지 더하는 코드가 있을 때 thread-1은 1 ~ 50까지의 합을 구하고, thread-2는 51 ~ 100까지의 합을 구하게 된다.
  - CPU 코어를 더 효과적으로 사용하려면 여러 스레드로 나누어 계산하면 된다.
- **CPU 코어가 2개라면 이론적으로 나누어 계산하므로 연산 속도가 2배 빨라진다.**

> 🔍 참고 - this
> - 호출된 인스턴스 메서드가 소속된 객체를 가리키는 참조이며, 이것이 스택 프레임 내부에 저장되어 있다.

- join()은 호출하는 스레드는 대상 스레드가 Terminated 상태가 될 때까지 대기한다.
- 이렇듯 특정 스레드가 완료될 때까지 기다려야 하는 상황이라면 join()을 사용하면 된다.
  - 하지만 join()의 단점은 다른 스레드가 완료될 때까지 무기한 기다리는 단점이 있다.

---

### 📚 join - 특정 시간만큼만 대기
- join()은 두 가지 메서드가 있다.
- 1. join()
- 2. join(ms): 호출 스레드가 특정 시간만큼만 대기한다.
    - 호출 스레드는 지정한 시간이 지나면 다시 Runnable 상태가 되면서 다음 코드를 수행한다.
- 특성 시간만큼만 대기하므로 Waiting 상태가 아닌 Time Waiting 상태가 된다.