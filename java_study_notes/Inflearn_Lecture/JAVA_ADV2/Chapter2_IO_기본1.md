# 📚 Chapter 1: 문자 인코딩

> 📌 공부 날짜: 2025/05/13
> - `JAVA `- 고급 1편
> - `Reference`: 인프런 - 김영한의 실전 자바

---

## ✅ 컴퓨터와 데이터
- 개발자가 개발하며 다루는 데이터는 크게 0101로 되어있는 바이너리 데이터(또는 byte 기반의 데이터)와 "ABC", "가나다"와 같은 문자로 되어있는 텍스트 데이터 두 가지다.
- **텍스트 데이터가 어떤 원리를 사용해서 만들어지는지 제대로 이해하지 못하면, 실무에서 한글 글자가 이상하게 깨져서 나올 때, 근본적인 원인을 찾아서 해결하기 어렵다.**

### 📚 2진수 - 숫자 저장 예시 (음수 표현)
- 음수를 표현해야 한다면 처음 1bit를 음수, 양수를 표현하는데 사용한다.
- ex) 8bit -> 256가지 표현
  - 0과 양수만 표현하는 경우
    - 8bit 모두 숫자 표현에 사용
    - 0 ~ 255
  - 음수 표현이 필요한 경우
    - 1bit는 음수와 양수를 구분하는 데 사용, 나머지 7bit로 숫자 범위 사용
    - 0 ~ 127 (양수 표현 시 첫 비트를 0으로 사용. 나머지 7bit로 128가지 0과 숫자 표현)
    - -128 ~ -1 (음수 표현 시 첫 비트를 -1로 사용, 나머지 7bit로 128가지 음수 숫자 표현)

---

## ✅ 컴퓨터와 문자 인코딩 1
### 📚 문자 집합 (Character Set)
- 예를 들어 우리가 문자 'A'를 저장하면, 컴퓨터는 문자 집합을 통해 'A'의 숫자 값 65를 찾는다. 그리고 65를 메모리에 저장한다. (2진수로 변환하여 저장)
  - 메모리에 저장된 문자를 불러올 때는 반대로 작동한다. 메모리에 저장된 숫자 값 65를 불러온다.
  - 그리고 문자 집합을 통해 문자 'A'를 찾아서 화면에 출력한다.

> - 🔍 **문자 인코딩:** 문자 집합을 통해 문자를 숫자로 변환하는 것.
> - 🔍 **문자 디코딩:** 문자 집합을 통해 숫자를 문자로 변환하는 것. 

---

### 📚 ASCII 문자 집합
- 각 컴퓨터 회사가 독자적인 문자 집합을 사용한다면, 서로 다른 컴퓨터 간에 문자가 올바르게 표시되지 않는 문제가 발생할 수 있다.
- 이러한 호환성 문제를 해결하기 위해 `ASCII(American Standard Code for Information Interchange)`라는 표준 집합이 개발됐다.
- 7bit를 사용하여 총 128가지 문자를 표현 가능하다.

### 📚 ISO-8859_1
- 서유럽 문자를 표현하는 문자 집합
- ISO_8859_1, LATIN1, ISO_LATIN-1 등으로 불림.
  - 8bit(1 byte) 문자 집합 -> 256가지 표현 가능.
  - 기존 7bit ASCII(0~127)를 그대로 유지.
- 기존 ASCII 문자 집합과 호환 가능.

### 📚 한글 문자 집합
- 한글을 표현할 수 있는 문자 집합

#### 1. EUC-KR
- 모든 한글을 담는 것보다는 자주 사용하는 한글 2350개만 포함해서 만들었다.
- 한글의 글자는 아주 많기 때문에 256가지만 표현할 수 있는 1byte로 표현하는 것은 불가능하다.
- 2byte(16bit)를 사용하면 총 65536가지 표현 가능.
- ASCII는 1byte, 한글은 2byte를 사용한다.
  - 영어를 사용하면 1byte를, 한글을 사용하면 2byte를 메모리에 저장한다.
- 기존 ASCII 문자 집합과 호환 가능하다.

#### 2. MS949
- 마이크로소프트가 EUC-KR을 확장하여 만든 인코딩.
- EUC-KR은 "뷁", "삡"과 같이 드물게 사용하는 음절을 표현하지 못한다.
- 기존 EUC-KR과 호환을 이루면서 한글 11,172자를 모두 수용하도록 만든 것이 MS949이다.
- ASCII는 1byte, 한글은 2byte를 사용.
- 기존 ASCII 문자 집합과 호환 가능하다.
- 윈도우 시스템에서 계속 사용된다.

### 📚 전 세계 문자 집합
- 전 세계 문자를 다 표현할 수 있는 문자 집합이 필요해졌다.

> 🔍 유니코드의 등장
> - 전 세계의 모든 문자들을 단일 문자 세트로 표현할 수 있는 유니코드(Unicode) 표준이 1990년대에 도입되었다.
> - UTF-16, UTF-8의 시작.

#### 1. UTF-16
- 16bit(2byte) 기반
- 자주 사용하는 기본 다국어들은 2byte로 표현, 2byte는 65536가지를 표현할 수 있다.
  - 영어, 유럽 언어, 한국어, 중국어, 일본어 등이 2byte로 사용한다.
- 그 외는 4byte로 표현, 4byte는 42억 가지를 표현할 수 있다.
- **단점**: ASCII 영문도 2byte를 사용한다. ASCII와 호환되지 않는다.
  - 영문의 경우 다른 문자 집합보다 2배의 메모리를 더 사용한다.

#### 2. UTF-8
- 8bit(1byte) 기반, 가변길이 인코딩
- 1byte ~ 4byte를 사용해서 문자를 인코딩
  - 1byte: ASCII, 영문, 기본 라틴 문자
  - 2byte: 그리스어, 히브리어 라틴 확장 문자
  - 3byte: 한글, 한자, 일본어
  - 4byte: 이모지, 고대문자 등
- **단점:** 상대적으로 사용이 복잡함.
  - ASCII를 제외한 일부 언어에서 더 많은 용량 사용.
- **장점:** ASCII 문자를 1byte로 표현, ASCII 호환
- **현대의 사실상 표준 인코딩 기술❗**

### 📌 정리
- UTF-8이 현대의 사실상 표준 인코딩 기술이 된 이유

### 1. 저장 공간 절약과 네트워크 효율성
- UTF-8은 ASCII 문자를 포함한 많은 서양 언어의 문자에 대해 1byte를 사용하기 때문에, 주로 ASCII 문자로 이루어진 영문 텍스트에서는 UTF-16보다 2배 더 효율적이다.
- 특히 데이터를 네트워크로 전달할 때는 매우 큰 효율의 차이를 보인다.

### 2. ASCII와의 호환성
- 많은 레거시 시스템은 ASCII 기반으로 구축되어 있어, UTF-8은 이러한 시스템과의 호환성을 유지하면서도 전 세계의 모든 문자를 표현할 수 있다.

> 결론: UTF-8을 사용하자.

---

### 📚 문자 집합 조회
#### 이용 가능한 모든 문자 집합 조회
- `Charset.availableCharsets()`를 사용하면 이용가능한 모든 문자 집합을 조회할 수 있다.

#### Charset.forName()
- 특정 문자 집합을 지정해서 찾을 때 사용하면 된다.
- 인자로 문자 집합의 이름이나 별칭을 사용하면 되는데, 대소문자는 구분하지 않는다.
- 별칭은 `aliases()` 메서드를 사용하면 구할 수 있다.

#### StandardCharsets.UTF_8
- 자주 사용하는 문자 집합은 `StandardCharsets`에 상수로 지정되어 있다.

#### Charsets.defaultCharset()
- 현재 시스템에서 사용하는 기본 문자 집합을 반환한다.

---

### 📚 문자 인코딩 예제 1
```java
// ex)
byte[] bytes = text.getBytes(charset);
```
- String.getByte(Charset) 메서드를 사용하면 String 문자를 byte 배열로 변경할 수 있다.
- 이때 중요한 점이 있는데, 문자를 byte로 변경하려면 문자 집합이 필요하다는 점이다.
  - 따라서 어떤 문자 집합을 참고해서 byte로 변경할지 정해야 한다.
  - String.getByte()의 인자로 Charset 객체를 전달하면 된다.
- 문자 집합을 지정하지 않은 현재 시스템에서 사용하는 기본 문자 집합을 인코딩에 사용한다.

---

## 📌 1장 정리
- `ASCII` 영문 인코딩: `UTF-16`을 제외하고 모두 호환.
- 사실상 표준인 `UTF-8`을 사용하자.

> 🤔 한글이 깨지는 가장 큰 2가지 이유
> - EUC-KR(MS949), UTF-8이 서로 호환되지 않는다.
>   - 혹은 한글을 지원하지 않는 문자 집합.
> - 한글이 깨지는 대부분의 문제는 UTF-8로 인코딩한 한글을 EUC-KR(MS949)로 디코딩하거나 또는 EUC-KR(MS949)로 인코딩한 한글을 UTF-8로 디코딩할 때 발생한다.

---
