# π“ Chapter 7: λ„¤νΈμ›ν¬ - ν”„λ΅κ·Έλ¨ 1

> π“ κ³µλ¶€ λ‚ μ§: 2025/05/24
> - `JAVA `- κ³ κΈ‰ 2νΈ
> - `References`: μΈν”„λ° - κΉ€μν•μ μ‹¤μ „ μλ°”

---

## β… λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨ 1 - μμ 

- μ—¬κΈ°μ„λ” TCP/IPλ΅ κ°λ°ν•  μμ •μ΄λ‹¤.
    - (UDPλ” μ§μ ‘ μ‚¬μ©ν•  μΌμ΄ λ§μ§€ μ•μΌλ―€λ΅ λ‹¤λ£¨μ§€ μ•μ.)

```java
public class ClientV1 {
    private static final int PORT = 12345;

    public static void main(String[] args) throws IOException {
        Socket socket = new Socket("localhost", PORT);
        DataInputStream input = new DataInputStream(socket.getInputStream());
        DataOutputStream output = new DataOutputStream(socket.getOutputStream());

        String toSend = "Hello"; // μ„λ²„μ—κ² λ¬Έμ λ³΄λ‚΄κΈ°
        output.writeUTF(toSend);

        String received = input.readUTF(); // μ„λ²„λ΅λ¶€ν„° λ¬Έμ λ°›κΈ°

        // μμ› μ •λ¦¬
        input.close();
        output.close();
        socket.close();
    }
}
```

```java
public class Server1 {
    private static final int PORT = 12345;

    public static void main(String[] args) {
        ServerSocket serverSocket = new ServerSocket(PORT);

        Socket socket = serverSocket.accept();
        DataInputStream input = new DataInputStream(socket.getInputStream());
        DataOutputStream output = new DataOutputStream(socket.getOutputStream());
        
        String received = input.readUTF(); // ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ¬Έμ λ°›κΈ°
        
        String toSend = received + "World!"; // ν΄λΌμ΄μ–ΈνΈμ—κ² λ¬Έμ λ³΄λ‚΄κΈ°
        output.writeUTF(toSend);
        
        // μμ› μ •λ¦¬
        input.close();
        output.close();
        socket.close();
        serverSocket.close();
    }
}
```
- **μ„λ²„λ¥Ό λ¨Όμ € μ‹¤ν–‰ν•κ³ , κ·Έλ‹¤μμ— ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•΄μ•Ό ν•λ‹¤.**
- `localhost`λ” ν„μ¬ μ‚¬μ© μ¤‘μΈ μ»΄ν“¨ν„° μμ²΄λ¥Ό κ°€λ¦¬ν‚¤λ” νΉλ³„ν• νΈμ¤νΈ μ΄λ¦„μ΄λ‹¤.
  - `google.com`, `naver.com`κ³Ό κ°™μ€ νΈμ¤νΈ μ΄λ¦„μ΄μ§€λ§, μκΈ° μμ‹ μ μ»΄ν“¨ν„°λ¥Ό λ»ν•λ” μ΄λ¦„μ΄λ‹¤.
- `localhost`λ” 127.0.0.1μ΄λΌλ” IPλ΅ λ§¤ν•‘λλ‹¤.
- 127.0.0.1μ€ IP μ£Όμ† μ²΄κ³„μ—μ„ λ£¨ν”„λ°± μ£Όμ†(loopBack address)λ΅ μ§€μ •λ νΉλ³„ν• IP μ£Όμ†μ΄λ‹¤.
  - μ΄ μ£Όμ†λ” μ»΄ν“¨ν„°κ°€ μ¤μ¤λ΅λ¥Ό κ°€λ¦¬ν‚¬ λ• μ‚¬μ©λλ©°, "localhost"μ™€ λ™μΌν•κ² μ·¨κΈ‰λλ‹¤.
- 127.0.0.1μ€ μ»΄ν“¨ν„°κ°€ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ™Έλ¶€λ΅ λ‚κ°€μ§€ μ•κ³ , μμ‹ μ—κ² μ§μ ‘ λ„¤νΈμ›ν¬ ν¨ν‚·μ„ λ³΄λ‚Ό μ μλ„λ΅ ν•λ‹¤.

> β οΈ **μ£Όμ - localhost**
> - λ§μ•½ `localhost`κ°€ μ λμ§€ μ•λ”λ‹¤λ©΄, μμ‹ μ PCμ μ΄μμ²΄μ μ— `localhost`κ°€ 127.0.0.1λ΅ λ§¤ν•‘λμ–΄ μμ§€ μ•μ€ λ¬Έμ μ΄λ‹¤.
> - μ΄ κ²½μ° `localhost` λ€μ‹ μ— 127.0.0.1μ„ μ§μ ‘ μ…λ ¥ν•λ©΄ λλ‹¤.

- **μ£Όμβ— - μ„λ²„ μ—°κ²° λ¶κ°€**
```text
java.net.ConnectException: Connection refused 
```
- μ„λ²„λ¥Ό μ‹μ‘ν•μ§€ μ•κ³ , ν΄λΌμ΄μ–ΈνΈλ§ μ‹¤ν–‰ν•λ©΄ ν•΄λ‹Ή μμ™Έκ°€ λ°μƒν•λ‹¤.

> β οΈ **μ£Όμ - BindException**
> ```text
> Exception in thread "main" java.net.BindException: Address already in use
> ```
> - λ§μ•½ μ΄λ° μμ™Έκ°€ λ°μƒν–λ‹¤λ©΄, μ΄λ―Έ 12345λΌλ” ν¬νΈλ¥Ό λ‹¤λ¥Έ ν”„λ΅μ„Έμ¤κ°€ μ‚¬μ©λκ³  μλ‹¤λ” λ»μ΄λ‹¤.
> - μΈν…”λ¦¬Jλ¥Ό μΆ…λ£ν•  λ• λ°λ“μ‹ `Terminate`λ΅ μΆ…λ£ν•΄μ•Ό ν•λ‹¤.
>   - `Disconnect`λ΅ μΆ…λ£ν•λ©΄ 12345 ν¬νΈλ¥Ό μ μ ν•κ³  μλ” μ„λ²„ ν”„λ΅μ„Έμ¤κ°€ κ·Έλ€λ΅ μ‚΄μ•„μλ” μƒνƒλ΅ μ μ§€λλ‹¤.
>   - λ”°λΌμ„ λ‹¤μ‹ μ‹¤ν–‰ν•  κ²½μ° 12345 ν¬νΈλ¥Ό μ‚¬μ©ν•μ§€ λ»ν•λ‹¤.

---

## β… λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨ 1 - λ¶„μ„
- TCP/IP ν†µμ‹ μ—μ„λ” ν†µμ‹ ν•  λ€μƒ μ„λ²„λ¥Ό μ°Ύμ„ λ• νΈμ¤νΈ μ΄λ¦„μ΄ μ•„λ‹λΌ, IP μ£Όμ†κ°€ ν•„μ”ν•λ‹¤.
- λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨μ„ λ¶„μ„ν•κΈ° μ „μ— λ¨Όμ € νΈμ¤νΈ μ΄λ¦„μΌλ΅ IPλ¥Ό μ–΄λ–»κ² μ°Ύλ”μ§€ ν™•μΈν•΄ λ³΄μ.

### π“ DNS νƒμƒ‰
```java
public class InetAddressMain { 
    public static void main(String[] args) {
        InetAddress localhost = InetAddress.getByName("localhost");
    
        InetAddress google = InetAddress.getByName("google.com");
    }
}
```
- μλ°”μ `InetAddress` ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ©΄ νΈμ¤νΈ μ΄λ¦„μΌλ΅ λ€μƒ IPλ¥Ό μ°Ύμ„ μ μλ‹¤.
    1. μλ°”λ” `InetAddress.getByName(νΈμ¤νΈλ…)` λ©”μ„λ“λ¥Ό μ‚¬μ©ν•΄μ„ ν•΄λ‹Ήν•λ” IP μ£Όμ†λ¥Ό μ΅°νν•λ‹¤.
    2. μ΄ κ³Όμ •μ—μ„ μ‹μ¤ν…μ νΈμ¤νΈ νμΌμ„ λ¨Όμ € ν™•μΈν•λ‹¤.
        - `/etc/hosts` (λ¦¬λ…μ¤, mac)
        - `C:\Windows\System32\drivers\etc\hosts` (μλ„μ°, Windows)
    3. νΈμ¤νΈ νμΌμ— μ •μλμ–΄ μμ§€ μ•λ‹¤λ©΄, DNS μ„λ²„μ— μ”μ²­ν•΄μ„ IP μ£Όμ†λ¥Ό μ–»λ”λ‹¤.

---

### π“ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ¶„μ„
#### π” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ—°κ²°μ `Socket`μ„ μ‚¬μ©ν•λ‹¤.
```java
Socket socket = new Socket("localhost", PORT);
```
- `localhost`λ¥Ό ν†µν•΄ μμ‹ μ μ»΄ν“¨ν„°μ— μλ” 12345 ν¬νΈμ— TCP μ ‘μ†μ„ μ‹λ„ν•λ‹¤.
  - `localhost`λ” IPκ°€ μ•„λ‹λ―€λ΅ ν•΄λ‹Ήν•λ” IPλ¥Ό λ¨Όμ € μ°Ύλ”λ‹¤. λ‚΄λ¶€μ—μ„ `InetAddress`λ¥Ό μ‚¬μ©.
  - `localhost`λ” 127.0.0.1μ΄λΌλ” IPμ— λ§¤ν•‘λμ–΄ μμ–΄, `127.0.0.1:12345`μ— TCP μ ‘μ†μ„ μ‹λ„ν•λ‹¤.
- μ—°κ²°μ΄ μ„±κ³µμ μΌλ΅ μ™„λ£λλ©΄ `Socket` κ°μ²΄λ¥Ό λ°ν™ν•λ‹¤.
- `Socket`μ€ μ„λ²„μ™€ μ—°κ²°λμ–΄ μλ” **μ—°κ²°μ **μ΄λΌκ³  μƒκ°ν•λ©΄ λλ‹¤.
- `Socket` κ°μ²΄λ¥Ό ν†µν•΄μ„ μ„λ²„μ™€ ν†µμ‹ ν•  μ μλ‹¤.

#### π” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ λ°μ΄ν„° ν†µμ‹ μ€ Socketμ΄ μ κ³µν•λ” μ¤νΈλ¦Όμ„ μ‚¬μ©ν•λ‹¤.
```java
DataInputStream input = new DataInputStream(socket.getInputStream());
DataOutputStream output = new DataOutputStream(socket.getOutputStream());
```
- `Socket`μ€ μ„λ²„μ™€ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›κΈ° μ„ν• μ¤νΈλ¦Όμ„ μ κ³µν•λ‹¤.
- `InputStream`: μ„λ²„μ—μ„ μ „λ‹¬ν• λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈκ°€ λ°›μ„ λ• μ‚¬μ©.
- `OutputStream`: ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„μ— λ°μ΄ν„°λ¥Ό μ „λ‹¬ν•  λ• μ‚¬μ©ν•λ‹¤.
- `InputStream`, `OutputStream`μ„ κ·Έλ€λ΅ μ‚¬μ©ν•λ©΄ λ¨λ“  λ°μ΄ν„°λ¥Ό `byte`λ΅ λ³€ν™ν•΄μ„ μ „λ‹¬ν•΄μ•Ό ν•κΈ° λ•λ¬Έμ— λ²κ±°λ΅­λ‹¤.
  - μ—¬κΈ°μ„λ” `DataInputStream`, `DataOutputStream`μ΄λΌλ” λ³΄μ΅° μ¤νΈλ¦Όμ„ μ‚¬μ©ν•΄μ„, μλ°” νƒ€μ…μ λ©”μ‹μ§€λ¥Ό νΈλ¦¬ν•κ² μ£Όκ³ λ°›μ„ μ μλ„λ΅ ν–λ‹¤.
    - λ‹¤λ¥Έ λ³΄μ΅° μ¤νΈλ¦Όλ„ κ°€λ¥.


- **β— μ‚¬μ©ν• μμ›μ€ λ°λ“μ‹ μ •λ¦¬ν•΄μ•Ό ν•λ‹¤.**

---

### π“ μ„λ²„ μ½”λ“ λ¶„μ„
#### π” μ„λ²„ μ†μΌ“
- μ„λ²„λ” νΉμ • ν¬νΈλ¥Ό μ—΄μ–΄λ‘μ–΄μ•Ό ν•λ‹¤. κ·Έλμ•Ό ν΄λΌμ΄μ–ΈνΈκ°€ ν•΄λ‹Ή ν¬νΈλ¥Ό μ§€μ •ν•΄μ„ μ ‘μ†ν•  μ μλ‹¤.
```java
ServerSocket serverSocket = new ServerSocket(PORT); 
```
- μ„λ²„λ” μ„λ²„ μ†μΌ“(`ServerSocket`)μ΄λΌλ” νΉλ³„ν• μ†μΌ“μ„ μ‚¬μ©ν•λ‹¤.
- μ§€μ •ν• ν¬νΈλ¥Ό μ‚¬μ©ν•΄μ„ μ„λ²„ μ†μΌ“μ„ μƒμ„±ν•λ©΄, ν΄λΌμ΄μ–ΈνΈλ” ν•΄λ‹Ή ν¬νΈλ΅ μ„λ²„μ— μ—°κ²°ν•  μ μλ‹¤.

> π” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ—°κ²° κ³Όμ •
> - μ„λ²„κ°€ 12345 ν¬νΈλ΅ μ„λ²„ μ†μΌ“μ„ μ—΄μ–΄λ‘”λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μ΄μ  12345 ν¬νΈλ΅ μ„λ²„μ— μ ‘μ†ν•  μ μλ‹¤.
> - ν΄λΌμ΄μ–ΈνΈκ°€ 12345 ν¬νΈμ— μ—°κ²°μ„ μ‹λ„.
> - μ΄λ• OS κ³„μΈµμ—μ„ TCP 3 way handshakeκ°€ λ°μƒν•κ³ , TCP μ—°κ²°μ΄ μ™„λ£λλ‹¤.
> - TCP μ—°κ²°μ΄ μ™„λ£λλ©΄ μ„λ²„λ” OS backlog queueλΌλ” κ³³μ— ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ TCP μ—°κ²° μ •λ³΄λ¥Ό λ³΄κ΄€ν•λ‹¤.
>   - μ΄ μ—°κ²° μ •λ³΄λ¥Ό λ³΄λ©΄ ν΄λΌμ΄μ–ΈνΈμ IP, PORT, μ„λ²„μ IP, PORT μ •λ³΄κ°€ λ¨λ‘ λ“¤μ–΄μλ‹¤.

#### π” ν΄λΌμ΄μ–ΈνΈμ™€ λλ¤ ν¬νΈ
- TCP μ—°κ²° μ‹μ—λ” ν΄λΌμ΄μ–ΈνΈ μ„λ²„ λ¨λ‘ IP, ν¬νΈ μ •λ³΄κ°€ ν•„μ”ν•λ‹¤.
- **ν΄λΌμ΄μ–ΈνΈ**: localhost(127.0.0.1), 50000(ν¬νΈ λλ¤ μƒμ„±)
- **μ„λ²„**: localhost, 12345
- **μ„λ²„μ κ²½μ° ν¬νΈκ°€ λ…ν™•ν•κ² μ§€μ •λμ–΄ μμ–΄μ•Ό ν•λ‹¤.**
    - κ·Έλμ•Ό ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„μ— μ–΄λ–¤ ν¬νΈμ— μ ‘μ†ν• μ§€ μ• μ μλ‹¤.
    - λ°λ©΄μ— μ„λ²„μ— μ ‘μ†ν•λ” ν΄λΌμ΄μ–ΈνΈμ κ²½μ°μ—λ” μμ‹ μ ν¬νΈκ°€ λ…ν™•ν•κ² μ§€μ •λμ–΄ μμ§€ μ•μ•„λ„ λλ‹¤.
    - ν΄λΌμ΄μ–ΈνΈλ” λ³΄ν†µ ν¬νΈλ¥Ό μƒλµν•λ”λ°, μƒλµν•  κ²½μ° ν΄λΌμ΄μ–ΈνΈ PCμ— λ‚¨μ•„μλ” ν¬νΈ μ¤‘ ν•λ‚κ°€ λλ¤μΌλ΅ ν• λ‹Ήλλ‹¤.
    - μ°Έκ³ λ΅ ν΄λΌμ΄μ–ΈνΈμ ν¬νΈλ„ λ…μ‹μ μΌλ΅ ν• λ‹Ήν•  μλ” μμ§€λ§ μ μ‚¬μ©β.

#### π” accept()
```java
Socket socket = serverSocket.accept();
```
- **μ„λ²„ μ†μΌ“μ€ λ‹¨μ§€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ TCP μ—°κ²°λ§ μ§€μ›ν•λ” νΉλ³„ν• μ†μΌ“μ΄λ‹¤.**
- μ‹¤μ  ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ •λ³΄λ¥Ό μ£Όκ³ λ°›μΌλ ¤λ©΄ `Socket` κ°μ²΄κ°€ ν•„μ”ν•¨. (**μ„λ²„ μ†μΌ“μ΄ μ•„λ‹λ‹¤β— μ†μΌ“μ΄λ‹¤β—**)
- `serverSocket.accept()` λ©”μ„λ“λ¥Ό νΈμ¶ν•λ©΄ TCP μ—°κ²° μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅, `Socket` κ°μ²΄λ¥Ό λ§λ“¤μ–΄μ„ λ°ν™ν•λ‹¤.

> `accpet()` νΈμ¶ κ³Όμ •
> - `accept()`λ¥Ό νΈμ¶ν•λ©΄ backlog queueμ—μ„ TCP μ—°κ²° μ •λ³΄λ¥Ό μ΅°νν•λ‹¤.
>   - λ§μ•½ TCP μ—°κ²° μ •λ³΄κ°€ μ—†λ‹¤λ©΄, μ—°κ²° μ •λ³΄κ°€ μƒμ„±λ  λ•κΉμ§€ λ€κΈ°ν•λ‹¤. (λΈ”λ΅ν‚Ή)
> - ν•΄λ‹Ή μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ `Socket` κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.
> - μ‚¬μ©ν• TCP μ—°κ²° μ •λ³΄λ” backlog queueμ—μ„ μ κ±°λλ‹¤.

- **μλ°”κ°€ ν•΄μ£Όλ” κ±΄ μ •λ³΄λ¥Ό κ°€μ Έμ™€ λ³΄λ‚΄λ” κ²ƒ. λ‚λ¨Έμ§„ OSκ°€ μ²λ¦¬(μ—°κ²°, μ €μ¥ λ“±)**

---

### π¤” λ¬Έμ 
- μ΄ ν”„λ΅κ·Έλ¨μ€ λ©”μ‹μ§€λ¥Ό ν•λ‚λ§ μ£Όκ³ λ°›μΌλ©΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ λ¨λ‘ μΆ…λ£λλ‹¤. λ©”μ‹μ§€λ¥Ό κ³„μ† μ£Όκ³ λ°›κ³ , μ›ν•  λ• μΆ…λ£ν•  μ μλ„λ΅ λ³€κ²½ν•΄μ•Ό ν•λ‹¤.

---

## β… λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨ 2 - μμ 
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ λ©”μ‹μ§€λ¥Ό μ£Όκ³ λ°›λ” λ¶€λ¶„λ§ `while`λ΅ λ°λ³µν•λ©΄ λλ‹¤.

```java
// ν΄λΌμ΄μ–ΈνΈ μ½”λ“
while (true) {
    String toSend = scanner.nextLine();
    output.writeUTF(toSend); // μ„λ²„: received = input.readUTF();
    
    if (toSend.equals("exit")) break; // μ„λ²„: received.equals("exit")
    
    String received = input.readUTF(); // μ„λ²„: String toSend = received + " World!"
                                       //      output.writeUTF(toSend);
}
```

### π¤” λ¬Έμ 
- μ„λ²„λ” ν•λ‚μ ν΄λΌμ΄μ–ΈνΈκ°€ μ•„λ‹λΌ, μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ μ²λ¦¬ν•  μ μμ–΄μ•Ό ν•λ‹¤.
- μƒλ΅μ΄ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄ ν„μ¬ μ½”λ“λ” μ •μƒ μν–‰μ΄ λμ§€ μ•λ”λ‹¤.

---

## β… λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨ 2 - λ¶„μ„
### π“ μ„λ²„ μ†μΌ“κ³Ό μ—°κ²° λ” μμ„Έν
- μ΄λ²μ—λ” μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ°”μ— μ ‘μ†ν•λ‹¤κ³  κ°€μ •.
- 50000λ² ν΄λΌμ΄μ–ΈνΈμ™€ 60000λ² ν΄λΌμ΄μ–ΈνΈ λ¨λ‘ μ„λ²„μ™€ μ—°κ²°ν•μ€κ³ , ν΄λΌμ΄μ–ΈνΈμ μ†μΌ“λ„ μ •μƒ μƒμ„±λλ‹¤.
- μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ™€ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μΌλ ¤λ©΄ μ†μΌ“μ„ νλ“ν•΄μ•Ό ν•λ‹¤.
- `ServerSocket.accept()` λ©”μ„λ“λ¥Ό νΈμ¶ν•λ©΄ backlog νμ μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ μ†μΌ“ κ°μ²΄λ¥Ό ν•λ‚ μƒμ„±ν•λ‹¤.
- νμ΄λ―€λ΅ μμ„λ€λ΅ λ°μ΄ν„°λ¥Ό κΊΌλ‚Έλ‹¤. 50000λ² ν΄λΌμ΄μ–ΈνΈμ μ ‘μ† μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ μ„λ²„μ— μ†μΌ“μ΄ ν•λ‚ μƒμ„±λλ‹¤.
- 60000λ² ν΄λΌμ΄μ–ΈνΈλ„ μ„λ²„μ™€ TCP μ—°κ²°μ΄ λμ—κΈ° λ•λ¬Έμ— μ„λ²„λ΅ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Ό μ μλ‹¤.
  - μ•„μ§ μ„λ²„μ— Socket κ°μ²΄κ°€ μ—†λ”λΌλ„ λ©”μ‹μ§€λ” λ³΄λ‚Ό μ μλ‹¤. TCP μ—°κ²°μ€ μ΄λ―Έ μ™„λ£λμ—λ‹¤.

> λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›λ” κ³Όμ •
> - **ν΄λΌμ΄μ–ΈνΈκ°€ "Hello, world!"λΌλ” λ©”μ‹μ§€λ¥Ό μ„λ²„μ— μ „μ†΅ν•λ” κ²½μ°**
>   - ν΄λΌμ΄μ–ΈνΈ
>     - μ• ν”λ¦¬μΌ€μ΄μ… β΅οΈ **OS TCP μ†΅μ‹  λ²„νΌ β΅οΈ ν΄λΌμ΄μ–ΈνΈ λ„¤νΈμ›ν¬ μΉ΄λ“**
>   - ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ©”μ‹μ§€κ°€ μ„λ²„μ— λ„μ°©ν–μ„ λ•, μ„λ²„
>     - μ„λ²„ λ„¤νΈμ›ν¬ μΉ΄λ“ β΅οΈ **OS TCP μμ‹  λ²„νΌ** β΅οΈ μ• ν”λ¦¬μΌ€μ΄μ…

- μ—¬κΈ°μ„ 60000λ² ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ©”μ‹μ§€λ” μ„λ²„ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ•„μ§ μ½μ§€ μ•μ•κΈ° λ•λ¬Έμ—, **μ„λ²„ OSμ TCP μμ‹  λ²„νΌμ—μ„ λ€κΈ°ν•κ² λλ‹¤.**


- **μ—¬κΈ°μ„ ν•µμ‹¬μ μΈ λ‚΄μ©μ΄ μλ”λ°, μ†μΌ“ κ°μ²΄ μ—†μ΄ μ„λ²„ μ†μΌ“λ§μΌλ΅ TCP μ—°κ²°μ€ μ™„λ£λλ‹¤λ” μ μ΄λ‹¤.**
  - (μ„λ²„ μ†μΌ“μ€ μ—°κ²°λ§ λ‹΄λ‹Ή)
- **ν•μ§€λ§ μ—°κ²° μ΄ν›„μ— μ„λ΅ λ©”μ‹μ§€λ¥Ό μ£Όκ³ λ°›μΌλ ¤λ©΄ μ†μΌ“ κ°μ²΄κ°€ ν•„μ”ν•λ‹¤.**

---

### π“ μμ  2 μ½”λ“μ λ¬Έμ 
- λ‘ μ΄μƒμ ν΄λΌμ΄μ–ΈνΈκ°€ μ‘λ™ν•μ§€ μ•λ” μ΄μ β—
  - μƒλ΅μ΄ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄?
    - μ„λ²„μ main μ¤λ λ“λ” `accept()` λ©”μ„λ“λ¥Ό μ λ€λ΅ νΈμ¶ν•  μ μ—†λ‹¤.
    - μ΄μ λ” `while`λ¬ΈμΌλ΅ κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈμ™€ λ©”μ‹μ§€λ¥Ό μ£Όκ³ λ°›λ” λ¶€λ¶„λ§ λ°λ³µν•κΈ° λ•λ¬Έμ΄λ‹¤.
    - `accept`λ¥Ό νΈμ¶ν•΄μ•Ό μ†μΌ“ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ™€ λ©”μ‹μ§€λ¥Ό μ£Όκ³ λ°›μ„ μ μλ‹¤.
  - 2κ°μ λΈ”λ΅ν‚Ή μ‘μ—… - ν•µμ‹¬μ€ λ³„λ„μ μ¤λ λ“κ°€ ν•„μ”ν•λ‹¤β—
    - `accept()`: ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ—°κ²°μ„ μ²λ¦¬ν•κΈ° μ„ν•΄ λ€κΈ°
    - `readXxx()`: ν΄λΌμ΄μ–ΈνΈμ λ©”μ‹μ§€λ¥Ό λ°›μ•„μ„ μ²λ¦¬ν•κΈ° μ„ν•΄ λ€κΈ°
    - κ°κ°μ λΈ”λ΅ν‚Ή μ‘μ—…μ€ λ³„λ„μ μ¤λ λ“μ—μ„ μ²λ¦¬ν•΄μ•Ό ν•λ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ λ‹¤λ¥Έ λΈ”λ΅ν‚Ή λ©”μ„λ“ λ•λ¬Έμ— κ³„μ† λ€κΈ°ν•  μ μλ‹¤.

---

## β… λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλ¨ 3
- μ΄λ²μ—λ” μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μ‹μ— μ ‘μ†ν•  μ μλ” μ„λ²„ ν”„λ΅κ·Έλ¨μ„ μ‘μ„±ν•΄ λ³΄μ.


- μ„λ²„μ `main` μ¤λ λ“λ” μ„λ²„ μ†μΌ“μ„ μƒμ„±ν•κ³ , μ„λ²„ μ†μΌ“μ `accept()`λ¥Ό λ°λ³µν•΄μ„ νΈμ¶ν•΄μ•Ό ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ ‘μ†ν•λ©΄ μ„λ²„ μ†μΌ“μ `accpet()` λ©”μ„λ“κ°€ `Socket`μ„ λ°ν™ν•λ‹¤.
- `main` μ¤λ λ“λ” μ΄ μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ `Runnable`μ„ κµ¬ν„ν• `Session`μ΄λΌλ” λ³„λ„μ κ°μ²΄λ¥Ό λ§λ“¤κ³ , μƒλ΅μ΄ μ¤λ λ“μ—μ„ μ΄ κ°μ²΄λ¥Ό μ‹¤ν–‰ν•λ‹¤.
  - μ—¬κΈ°μ„λ” `Thread-0`μ΄ `Session`μ„ μ‹¤ν–‰ν•λ‹¤.
- `Session` κ°μ²΄μ™€ `Thread-0`μ€ μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈμ™€ λ©”μ‹μ§€λ¥Ό μ£Όκ³ λ°›λ”λ‹¤.
- μƒλ΅μ΄ TCP μ—°κ²°μ΄ λ°μƒν•λ©΄ `main` μ¤λ λ“λ” μƒλ΅μ΄ `Session` κ°μ²΄λ¥Ό λ³„λ„μ μ¤λ λ“μ—μ„ μ‹¤ν–‰ν•λ‹¤. κ·Έλ¦¬κ³  μ΄ κ³Όμ •μ„ λ°λ³µν•λ‹¤.

#### π” μ—­ν• μ λ¶„λ¦¬
- `main` μ¤λ λ“
  - `main` μ¤λ λ“λ” μƒλ΅μ΄ μ—°κ²°μ΄ μμ„ λ•λ§λ‹¤ `Session` κ°μ²΄μ™€ λ³„λ„μ μ¤λ λ“λ¥Ό μƒμ„±ν•κ³ , λ³„λ„μ μ¤λ λ“κ°€ `Session` κ°μ²΄λ¥Ό μ‹¤ν–‰ν•λ„λ΅ ν•λ‹¤.
- `Session` λ‹΄λ‹Ή μ¤λ λ“
  - `Session`μ„ λ‹΄λ‹Ήν•λ” μ¤λ λ“λ” μμ‹ μ μ†μΌ“μ΄ μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈμ™€ λ©”μ‹μ§€λ¥Ό λ°λ³µν•΄μ„ μ£Όκ³ λ°›λ” μ—­ν• μ„ λ‹΄λ‹Ή.

```java
public class SessionV3 implements Runnable {
    private final Socket socket;
    
    public SessionV3(Socket socket) {
        this.socket = socket;
    }
    
    @Override
    public void run() {
        try {
            DataInputStream input = new DataInputStream(socket.getInputStream());
            DataOutputStream output = new DataOutputStream(socket.getOutputStream());
            
            while (true) {
                String received = input.readUTF(); // λΈ”λ΅ν‚Ή
              
                if (received.equals("exit")) break;
                
                String toSend = received + " World!";
                output.writeUTF(toSend);
            }
            
            // μμ› μ •λ¦¬
            input.close();
            output.close();
            socket.close();
        } catch (IOException e) {
            throw new RunTimeException(e);
        }
}
```
- `Runnable`μ„ κµ¬ν„ν•΄μ„ λ³„λ„μ μ¤λ λ“μ—μ„ μ‹¤ν–‰ν•λ‹¤.

```java
public class ServerV3 {
    private static final int PORT = 12345;

  public static void main(String[] args) throws IOException {
      ServerSocket serverSocket = new ServerSocket(PORT);
      
      while (true) {
        Socket socket = serverSocket.accept(); // λΈ”λ΅ν‚Ή
        
        SessionV3 session = new SessionV3(socket);
        Thread thread = new Thread(session);
        thread.start(); // sessionμ run() νΈμ¶
      }
  }
}
```
- `main` μ¤λ λ“λ” μ„λ²„ μ†μΌ“μ„ μƒμ„±ν•κ³ , `serverSocket.accept()`μ„ νΈμ¶ν•΄μ„ μ—°κ²°μ„ λ€κΈ°ν•λ‹¤.
- μƒλ΅μ΄ μ—°κ²°μ΄ μ¶”κ°€λ  λ•λ§λ‹¤ `Session` κ°μ²΄λ¥Ό μƒμ„±ν•κ³  λ³„λ„μ μ¤λ λ“μ—μ„ `Session` κ°μ²΄λ¥Ό μ‹¤ν–‰ν•λ‹¤.
- μ΄ κ³Όμ •μ„ λ°λ³µ.


- **λΈ”λ΅ν‚Ήλλ” λ¶€λ¶„μ€ μ΄λ ‡κ² λ³„λ„μ μ¤λ λ“λ΅ λ‚λ„μ–΄ μ‹¤ν–‰ν•΄μ•Ό ν•λ‹¤.**

#### π¤” λ¬Έμ 
- **μ—¬κΈ°μ„ μ‹¤ν–‰ μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈλ¥Ό μΈν…”λ¦¬Jμ λΉ¨κ°„μƒ‰ Stop λ²„νΌμ„ λλ¬μ„ μ§μ ‘ μΆ…λ£ν•  μ‹?**
- ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ μ§μ ‘ μΆ…λ£ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ„Έμ¤κ°€ μΆ…λ£λλ©΄μ„, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ TCP μ—°κ²°λ„ ν•¨κ» μΆ…λ£λλ‹¤.
  - μ΄λ• μ„λ²„μ—μ„ `readUTF()`λ΅ ν΄λΌμ΄μ–ΈνΈκ°€ λ©”μ‹μ§€λ¥Ό μ½μΌλ ¤κ³  ν•λ©΄ `EOFException`μ΄ λ°μƒ.
  - μ†μΌ“μ TCP μ—°κ²°μ΄ μΆ…λ£λμ—κΈ° λ•λ¬Έμ— λ”λ” μ½μ„ μ μλ” λ©”μ‹μ§€κ°€ μ—†λ‹¤λ” λ»μ΄λ‹¤.
  - EOF(νμΌμ λ)κ°€ μ—¬κΈ°μ„λ” μ „μ†΅μ λμ΄λΌλ” λ»μ΄λ‹¤.
- **κ·Έλ°λ° μ—¬κΈ°μ„ μ‹¬κ°ν• λ¬Έμ κ°€ ν•λ‚ μλ‹¤. μ΄λ ‡κ² μμ™Έκ°€ λ°μƒν•΄ λ²„λ¦¬λ©΄ μ„λ²„μ—μ„ μμ› μ •λ¦¬ μ½”λ“λ¥Ό νΈμ¶ν•μ§€ λ»ν•λ‹¤λ” μ μ΄λ‹¤.**

#### π” μλ„μ° OS λ‚΄μ© μ¶”κ°€
- **ν΄λΌμ΄μ–ΈνΈλ¥Ό μ§μ ‘ μΆ…λ£ν• κ²½μ° μ„λ²„ λ΅κ·Έ - μλ„μ°**
- μ°Έκ³ λ΅ μλ„μ°μ κ²½μ° `java.io.EOFException`μ΄ μ•„λ‹λΌ `java.net.SocketException: Connection reset`μ΄ λ°μƒν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ μ§μ ‘ μΆ…λ£ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ„Έμ¤κ°€ μΆ…λ£λλ©΄μ„, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ TCP μ—°κ²°λ„ ν•¨κ» μΆ…λ£λλ‹¤.
  - μ΄λ• μ†μΌ“μ„ μ •μƒμ μΌλ΅ λ‹«μ§€ μ•κ³  ν”„λ΅κ·Έλ¨μ„ μΆ…λ£ν–κΈ° λ•λ¬Έμ— κ°κ°μ OSλ” λ‚¨μ•„μλ” TCP μ—°κ²°μ„ μ •λ¦¬ν•λ ¤κ³  μ‹λ„ν•λ‹¤.
  - μ΄λ• MACκ³Ό μλ„μ° OSμ TCP μ—°κ²° μ •λ¦¬ λ°©μ‹μ΄ λ‹¤λ¥΄λ‹¤.
    - MAC: TCP μ—°κ²° μ •μƒ μΆ…λ£
    - μλ„μ°: TCP μ—°κ²° κ°•μ  μΆ…λ£


- μλ°” κ°μ²΄λ” GCκ°€ λμ§€λ§, μλ°” μ™Έλ¶€μ μμ›μ€ μλ™μΌλ΅ GCκ°€ λλ” κ² μ•„λ‹λ‹¤. λ”°λΌμ„ κΌ­! μ •λ¦¬λ¥Ό ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.
- (TCP μ—°κ²°μ κ²½μ° μ΄μμ²΄μ κ°€ μ–΄λ μ •λ„ μ—°κ²°μ„ μ •λ¦¬ν•΄ μ£Όμ§€λ§, μ§μ ‘ μ—°κ²°μ„ μΆ…λ£ν•  λ•λ³΄λ‹¤ λ” λ§μ€ μ‹κ°„μ΄ κ±Έλ¦΄ μ μλ‹¤.)


#### β— μμ› μ •λ¦¬λ¥Ό μ λ€λ΅ ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.

---

## β… μμ› μ •λ¦¬ 1